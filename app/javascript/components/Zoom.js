import React from "react"
import PropTypes from "prop-types"

class Zoom extends React.Component {
    constructor(props) {
        super(props);
        this.mouseMove = this.mouseMove.bind(this);
        this.mouseLeave = this.mouseLeave.bind(this);
        this.state = {
            mode: 'waiting',
            id: btoa(Math.random().toString(36)), // ~Random id so we can have two on the same page
        }
        this.ComponentDidUpdate = this.ComponentDidUpdate.bind(this);

    }

    ComponentDidUpdate() {
        this.render()
    }

    mouseMove(e) {
        let cont = document.getElementById('zoom_container_' + this.state.id);
        let pageX = e.clientX - cont.getBoundingClientRect().left;
        let pageY = e.clientY - cont.getBoundingClientRect().top;
        let origin = pageX + 'px ' + pageY + 'px';
        this.setState({
            mode: 'live',
            origin: origin
        });
    }

    mouseLeave() {
        this.state.mode = 'waiting'
    }

    render() {
        let style = {
            backgroundImage: "url('" + this.props.url + "')",
        };
        if (this.state && this.state.mode == 'live') {
            style = {
                backgroundImage: "url('" + this.props.url + "')",
                transformOrigin: this.state.origin,
            };
        }
        let venomous = "";
        if (this.props.venomous == true) {
            venomous = <svg title='This species may be venemous' version="1.1" id="poison_icon" xmlns="http://www.w3.org/2000/svg"
                            xmlnsXlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 750 682.9"
                            xmlSpace="preserve">
                <path className="st0"
                      d="M189.5,128.6c-8.9,8.7-11.2,19.5-11.7,31c-0.8,18.2,3.2,35.6,8.7,52.7c5.6,17.3,7.1,34.8,4,52.7c-0.3,1.5-0.8,3-1.4,5.5c-1.6-2.3-2.8-3.7-3.8-5.3c-13.5-21.9-22.8-45.5-26.8-71c-3.1-20-4.4-40-0.2-59.9c7.6-36.6,26.2-66.8,55.4-90.3c20.3-16.3,43.6-26.6,68.6-33.2c23.8-6.3,48-10,72.5-11.7C373.8-2,393-2.4,412,0c34.5,4.3,68.2,12.3,99.9,26.9c18.6,8.6,33.1,22.4,45.8,38.2c17.5,21.8,29.8,46.2,34.8,73.9c2.6,14.2,2.6,28.7,1.9,43.1c-0.5,11.2-0.9,22.4-4.7,33.1c-5,14.1-11.3,27.6-18.9,40.5c-2.3,3.9-5.2,7.5-7.9,11.2c-0.3-0.1-0.6-0.1-0.9-0.2c-0.6-4.1-1.4-8.2-1.7-12.4c-1-15.6,1.1-30.9,6-45.7c5.6-17.1,8.8-34.5,8-52.5c-0.5-10.8-5.1-21.3-12.6-28.3c-3.5,3.5-7,7.1-10.4,10.7c-1.6,1.7-1.5,3.4-0.6,5.6c1.3,3.1,2.7,6.4,3,9.7c1.3,14.1,0.5,28-4,41.7c-2.9,9-6.2,18.2-6.9,27.5c-1.1,14.6-1.2,29.5,0.1,44.1c1.7,18.1,5.4,36,8,54.1c2.6,17.6-1.4,34.1-9.3,49.8c-2.2,4.4-5.7,7.7-10.3,9.7c-11.2,4.9-22.6,9.4-33.7,14.7c-7.8,3.7-15.4,7.9-22.6,12.5c-14.6,9.2-23.6,22.6-25.8,39.7c-1,7.8-4.2,11.5-11.8,12c-7.3,0.5-14.6,1.8-22,2c-27.1,0.7-54.2,1.5-81.3,1.3c-9.3-0.1-18.7-3-28-4.8c-0.8-0.2-1.6-1.7-1.8-2.8c-0.9-4.5-1.3-9.1-2.4-13.5c-4.8-18.6-17-31.4-33.6-39.8c-10.8-5.4-22.4-9.2-33.7-13.7c-2.8-1.1-5.5-2.3-8.2-3.5c-13.2-5.7-19.1-16.9-22.7-29.9c-3.7-13.5-3.1-27-0.9-40.6c2.3-14.6,5.4-29.2,6.9-43.9c1.7-17,2.3-34.1-0.3-51.1c-1-6.6-3.5-12.9-5.4-19.4c-4.2-14.4-7.6-29-5.9-44.1c0.4-3.5,2.1-7.1,3.8-10.2c1.2-2.3,1-3.8-0.6-5.4C197.2,136.3,193.4,132.5,189.5,128.6z M466,347.8c20-0.3,34.4-7,42.9-22.3c6.8-12.2,11.7-25.5,17.1-38.5c1.2-2.9,1.6-6.5,1.3-9.7c-1.4-14.6-13.2-28-27.6-31.5c-23.7-5.7-48-7.9-72.2-9.5c-1-0.1-2.4,0.3-3.1,1c-2.9,2.7-5.8,5.4-8.3,8.4c-9.2,11.2-12.1,23.7-6.4,37.3c9.1,21.8,22.4,40.9,39.5,57.3C454.6,345.6,461.1,348,466,347.8z M312,237c-9.1,1.1-22.4,2.2-35.5,4.3c-10.3,1.6-20.7,3.4-30.5,6.7c-15.8,5.4-23.3,19.8-20.4,36.2c2.3,13.3,7.4,25.6,13.6,37.4c6.1,11.5,15.6,19.4,27.7,24c13.7,5.2,26.3,3.5,37-7.5c13.8-14.2,25.4-29.8,34.7-47.3c5.3-10,6.4-20.4,3.8-31.3C338.7,244.5,329.8,236.8,312,237z M369.8,325c-2.3,1.5-4.2,2.5-5.7,3.8c-21.1,19.6-33.4,42.9-31.1,72.5c0.4,5.5,1.2,11.1,2.9,16.3c3.8,11.2,11.2,13.1,20.2,5.4c4.9-4.3,9-9.6,13.4-14.5c0.6-0.7,0.9-1.9,0.9-2.9c0.1-24.5,0.2-49,0.2-73.6C370.6,329.9,370.2,327.9,369.8,325z M381.5,325.2c-0.3,1.6-0.6,2.5-0.6,3.4c-0.2,4.5-0.6,8.9-0.6,13.4c-0.1,18.8,0.1,37.6-0.4,56.3c-0.2,6.8,1.6,12.1,6.2,16.9c4.3,4.6,8.6,8.9,14.5,11.3c2.6,1.1,5.1,1.3,7.6-0.5c4.3-3.1,7.7-7.1,7.9-12.6c0.4-11.7,0.5-23.4,0.3-35.2c0-3.2-1.1-6.5-2.3-9.6c-6.1-15.4-15.8-28.4-27.6-39.9C385.2,327.5,383.5,326.6,381.5,325.2z"/>
                <path className="st0"
                      d="M246.8,413.4c1.1,1.9,2.6,3.8,3.3,5.9c4.6,12.7,9.3,25.4,13.3,38.3c5,15.9,7.6,32.4,9.7,48.9c0.3,2.5,1.2,4.3,3.1,6c9.4,8.6,18.9,16.9,30.7,22.3c14,6.4,28.8,9.5,44,10.1c18,0.7,36.1,0.9,54,0c20.7-1,39.3-9.1,56.4-20.6c11.3-7.6,15.7-18.7,17.6-31.9c3.5-23.4,9.4-46.4,18.5-68.4c1.6-3.8,3.9-7.4,5.9-11.1c0.5,0.2,1,0.4,1.5,0.5c-0.3,1.7-0.4,3.4-0.8,5c-2.6,8.8-5.4,17.5-7.8,26.3c-4.4,16.1-3.5,32.6-3,49c0.5,15.2-0.4,30.3-6.1,44.7c-3.2,8.1-7.7,15.5-13.4,22.1c-8.3,9.5-16.5,19.3-28,25c-15.6,7.7-32,13-49.5,13.8c-17.6,0.8-35.2,1-52.8-1.2c-39.8-5-67.4-25.9-81.4-63.7c-4.9-13.3-4.9-27.4-4.7-41.4c0.1-11.5,0.1-23-0.6-34.5c-0.7-12.1-5.1-23.5-8.8-34.9c-1-3.1-1.6-6.3-2.4-9.5C245.9,413.8,246.4,413.6,246.8,413.4z"/>
                <path className="st0"
                      d="M510.5,477.1c0.7-13.7,4-26.4,8.3-38.9c1.5-4.4,2.1-9.7,5-13c2.9-3.3,8.1-4.5,12.2-6.6c32.6-16.3,65.2-32.6,97.7-49.1c9.4-4.8,18.7-10.1,25.4-18.6c3.8-4.9,7-10.4,10-15.9c4.7-8.8,9-17.8,16.1-24.9c3.3-3.3,7-6.4,10.9-8.7c5.4-3.1,8.9-1.5,10.8,4.3c3.8,11.6,6.4,23.5,7,35.7c0.3,6.7,2.4,12.2,6.7,17.1c7,7.9,14.1,15.7,21,23.7c2.3,2.6,4.5,5.5,6.3,8.4c3.6,5.7,2.5,8.7-3.7,11.1c-7.6,2.9-15.5,4.4-23.5,3.7c-10.1-0.8-20.1-2.2-30.2-3.5c-7.9-1-15.5-0.2-22.8,3c-23.2,10.5-46.5,20.8-69.6,31.5c-28.1,12.9-56,26.1-84,39.2C513.1,476.2,511.9,476.6,510.5,477.1z"/>
                <path className="st0"
                      d="M61.6,399.7c-9.7,0.9-19.1,2-28.5,2.7c-9.3,0.7-18.6,0.2-27.4-3.4c-6.3-2.6-7.3-5.1-3.5-10.7c3.9-5.6,8.4-10.7,12.9-15.8c3.7-4.1,7.7-8,11.7-11.8c6.4-6,9.2-13.6,10-22.2c1-9.3,2.4-18.6,3.8-27.9c0.2-1.5,0.7-2.9,1.3-4.2c2.8-6.2,8.2-8.4,13.8-4.8c4.7,3,9.1,7,12.7,11.4c4,4.9,7.2,10.6,10.4,16c16.4,27.4,13.8,25,39.7,38.8c34.9,18.6,70.3,36.1,105.6,54c2.4,1.2,3.8,2.7,4.4,5.3c3.1,12.2,6.4,24.3,9.4,36.5c0.7,2.7,0.7,5.7,0.6,8.6c-0.1,3.2-0.9,3.5-3.8,2.2c-11.5-5.4-22.9-10.9-34.3-16.3c-31.9-15.3-63.7-30.8-95.7-46c-10.5-5-21.2-9.6-32.8-11.4C68.7,400.1,65.1,400,61.6,399.7z"/>
                <path className="st0"
                      d="M507.6,528.4c9,4.2,18.6,8.6,28.1,13c25.5,11.7,50.9,23.3,76.4,35.1c10.7,4.9,21.7,5.6,33.4,4.2c12.4-1.4,25.1-1.1,37.7-1.2c5.3-0.1,9.2,2.9,12.4,6.9c1.6,2.1,1.9,3.8-0.1,5.8c-6,6.2-11.9,12.5-17.9,18.7c-5.2,5.3-10.8,10.4-16,15.7c-1.1,1.1-1.9,2.8-2.1,4.3c-1.7,12.3-3.1,24.7-5,37.1c-0.6,3.7-2,7.4-3.6,10.9c-2,4.4-3.8,4.8-8.1,2.5c-10-5.3-16.8-13.6-22.2-23.3c-1.7-3.1-3.4-6.2-5-9.3c-6.5-12.8-16-23-28.4-30c-19.9-11.2-40-21.9-60-32.8c-9.5-5.1-18.9-10.3-28.4-15.4c-2.1-1.1-3-2.4-2.1-4.8c0.9-2.5,1.4-5.1,2.1-7.7C501.5,548.4,504.5,538.6,507.6,528.4z"/>
                <path className="st0"
                      d="M243.3,527c4.1,12.7,7.9,25,12,37.2c0.9,2.7,0.1,3.9-2.3,5.2c-32.7,17.2-65.4,34.5-98.1,51.8c-1.6,0.9-3.1,2.2-4.2,3.7c-10,14.3-19.8,28.8-29.9,43.1c-2.6,3.7-6,7-9.5,9.9c-5.9,4.9-10.7,3.2-12.1-4.4c-2-11.1-3.6-22.3-5.2-33.5c-0.5-3.4-0.7-6.8-1.4-10.1c-0.2-1.2-1.1-2.5-2-3.4c-9.8-10.7-19.8-21.2-29.6-31.9c-1.4-1.6-2.6-3.4-3.8-5.2c-2.3-3.7-1.9-7,2-9.2c2.6-1.5,5.7-2.8,8.6-2.9c9.8-0.1,19.6,0.4,29.4,0.9c14.1,0.6,28.2,2.4,41.8-2.6c10.5-3.8,20.9-8,31-12.8c22.8-10.8,45.4-22.2,68-33.3C239.9,528.4,241.9,527.6,243.3,527z"/>
                <path className="st0"
                      d="M289.4,511.2c-3.3-2.8-6.1-5.4-6.7-9.8c-2.1-16.1-4.6-32.1-9.5-47.6c-3.2-10.1-6.6-20-10-30c-0.4-1.1-0.7-2.2-1.3-3.9c13.3,8.2,22,18.5,22.5,34.2c0.1,3,1.3,4.5,3.8,5.8c1,0.5,2,2,2,3.1c-0.1,15.7-0.3,31.4-0.5,47.1C289.8,510.2,289.6,510.5,289.4,511.2z"/>
                <path className="st0"
                      d="M486.6,422.5c-3,9.1-5.9,17.8-8.6,26.5c-5.3,16.7-8.6,33.8-10.7,51.2c-0.6,4.7-1.7,7-5.8,10.8c-0.2-2.2-0.6-4.2-0.6-6.1c-0.2-14-0.4-27.9-0.5-41.9c0-1.2,0.9-3,1.9-3.4c4.2-1.8,5.1-5,5.4-9.1c0.9-12.2,7.8-20.8,17.5-27.6C485.5,422.6,485.9,422.7,486.6,422.5z"/>
                <path className="st0"
                      d="M371.9,502.6c-4.7,0-9.3,0-14,0c0-9.9,0-19.7,0-29.7c4.6,0,9.1,0,14,0C371.9,482.7,371.9,492.5,371.9,502.6z"/>
                <path className="st0"
                      d="M372,536.5c-4.7,0-9.3,0-14,0c0-8.7,0-17.1,0-25.7c4.6,0,9.2,0,14,0C372,519.4,372,528,372,536.5z"/>
                <path className="st0"
                      d="M392.4,502c-4.3,0.3-8.3,0.6-12.6,0.9c0-10,0-19.8,0-29.9c4.1,0,8.3,0,12.6,0C392.4,482.6,392.4,492.2,392.4,502z"/>
                <path className="st0"
                      d="M419.2,470.8c4.7-0.7,8.9-1.3,13.4-1.9c0.3,8.3,0.6,16.5,0.8,24.7c0,0.6-0.7,1.6-1.3,1.8c-3.3,1.1-6.7,2-10.1,2.9c-1.9,0.5-2.8-0.2-2.8-2.3C419.3,487.6,419.2,479.3,419.2,470.8z"/>
                <path className="st0"
                      d="M317.3,495c0-8.8,0-17,0-25.8c4.8,0.7,9.1,1.3,13.3,1.9c0,9.4,0,18.4,0,28C325.9,497.7,321.5,496.3,317.3,495z"/>
                <path className="st0"
                      d="M392.5,536.9c-3.4,0.2-7,0.3-10.6,0.5c-1.6,0.1-2.3-0.6-2.3-2.2c0-7.6-0.1-15.1,0-22.7c0-0.7,1.2-2,1.9-2.1c3.5-0.4,7-0.5,11.1-0.7C392.5,518.9,392.5,527.7,392.5,536.9z"/>
                <path className="st0"
                      d="M330.3,531.9c-1,0-1.1,0-1.2,0c-3.9-1.3-7.8-2.6-11.8-3.9c-0.1-3.8-0.3-7.6-0.3-11.4c-0.1-4.2,0-8.5,0-13.3c4.7,1.3,8.6,2.3,12.5,3.4c0.5,0.2,1.3,1,1.3,1.5C330.6,516,330.4,523.9,330.3,531.9z"/>
                <path className="st0"
                      d="M419.6,532.6c0-6.7,0-12.7,0-18.6c0-7.4,0-7.4,7.1-9.1c1.9-0.5,3.9-0.9,6.1-1.4c0.2,1,0.4,1.8,0.4,2.6c0,6.7,0,13.4-0.2,20.1c0,0.8-0.7,2.2-1.4,2.4C428.1,530,424.4,531.1,419.6,532.6z"/>
                <path className="st0"
                      d="M338.6,472.7c0.4-0.4,0.5-0.5,0.6-0.5c12.7-0.1,10.5-1.3,10.8,9.5c0.2,6.7,0,13.3,0,19.7c-1,0.4-1.2,0.5-1.4,0.5c-11.4-1.7-9.8,1-10-10.8C338.5,484.9,338.6,478.7,338.6,472.7z"/>
                <path className="st0"
                      d="M412,500.1c-3.9,0.5-7.5,1-11.6,1.5c0-4.9,0-9.5,0-14c0-4.3,0.1-8.5,0-12.8c0-1.9,0.6-2.7,2.5-2.8c2.5,0,5.1-0.2,8.1-0.4C411.3,481.2,411.6,490.5,412,500.1z"/>
                <path className="st0"
                      d="M338.3,508.4c4.2,0.5,7.7,1,11.4,1.5c0,8.5,0,16.8,0,25.7c-3.7-0.5-7.2-1-10.7-1.6c-0.4-0.1-1.1-1.1-1-1.6C338.1,524.5,338.2,516.6,338.3,508.4z"/>
                <path className="st0"
                      d="M441.5,524.7c-0.2-2.4-0.3-4.1-0.4-5.7c-0.2-5.2-0.3-10.5-0.7-15.7c-0.1-2,0.5-3.1,2.3-3.9c3.2-1.4,6.3-3.1,10-4.9c0.2,1.5,0.3,2.6,0.4,3.7c0.1,5.9,0.1,11.7,0,17.6c0,0.9-0.3,2.4-0.9,2.8C448.9,520.7,445.5,522.5,441.5,524.7z"/>
                <path className="st0"
                      d="M411.5,508.2c0,8.4,0,16.5-0.1,24.7c0,0.6-1,1.6-1.7,1.8c-2.9,0.5-5.9,0.7-9.3,1c0-7,0-13.5,0-20c0.1-6.2,0.1-6.2,6.2-7C408.2,508.4,409.7,508.3,411.5,508.2z"/>
                <path className="st0"
                      d="M452.6,463.9c0,5.4-0.4,10.3,0.1,15.1c0.6,5.2-1.3,8.2-6,9.9c-2,0.7-3.7,1.9-6.1,3.1c0-8.2,0-16,0-23.7c0-0.5,0.5-1.2,1-1.4C445,465.9,448.5,465,452.6,463.9z"/>
                <path className="st0"
                      d="M309.6,467.5c0,8.1,0,15.9,0,24.5c-4-2.1-7.6-4-11.2-6c-0.4-0.2-0.7-0.9-0.7-1.3c0.1-6.5,0.3-13,0.4-19.5c0-0.2,0.2-0.3,0.5-0.7C302.2,465.5,305.9,466.5,309.6,467.5z"/>
                <path className="st0"
                      d="M297.6,494.8c4.2,1.9,7.3,3.3,10.3,4.8c0.5,0.3,1.1,1.1,1.1,1.6c0.1,7.5,0.1,15,0.1,22.5c-0.3,0.2-0.6,0.4-0.9,0.6c-3.4-2.1-6.7-4.1-10.1-6.3c-0.3-0.2-0.5-0.9-0.5-1.4C297.6,509.7,297.6,502.7,297.6,494.8z"/>
            </svg>
        }

        return (
            <React.Fragment>

                <div className={'zoom_container'} id={'zoom_container_' + this.state.id} onMouseLeave={this.mouseLeave}
                     onMouseMove={this.mouseMove}>

                    {venomous}
                    <div className={'zoom'} id={'zoom_' + this.state.id} style={style}>
                        <img className={'zoom_image'} id={'zoom_image_' + this.state.id}
                             src={this.props.url}/>

                    </div>
                </div>
            </React.Fragment>
        );
    }
}

Zoom.propTypes = {
    url: PropTypes.string,
    venomous: PropTypes.bool,
};
export default Zoom
